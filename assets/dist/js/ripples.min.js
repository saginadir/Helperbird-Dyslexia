/* Copyright 2014+, Federico Zivolo, LICENSE at https://github.com/FezVrasta/bootstrap-material-design/blob/master/LICENSE.md */
/* globals jQuery, navigator */
!function(t,e,o,i){"use strict";/**
   * Create the main plugin function
   */
function n(e,o){a=this,this.element=t(e),this.options=t.extend({},p,o),this._defaults=p,this._name=r,this.init()}/**
   * Define the name of the plugin
   */
var r="ripples",a=null,p={};/**
   * Initialize the plugin
   */
n.prototype.init=function(){var o=this.element;o.on("mousedown touchstart",function(i){/**
       * Verify if the user is just touching on a device and return if so
       */
if(!a.isTouch()||"mousedown"!==i.type){/**
       * Verify if the current element already has a ripple wrapper element and
       * creates if it doesn't
       */
o.find(".ripple-wrapper").length||o.append('<div class="ripple-wrapper"></div>');/**
       * Find the ripple wrapper
       */
var n=o.children(".ripple-wrapper"),r=a.getRelY(n,i),p=a.getRelX(n,i);/**
       * If relY and/or relX are false, return the event
       */
if(r||p){/**
       * Get the ripple color
       */
var s=a.getRipplesColor(o),u=t("<div></div>");u.addClass("ripple").css({left:p,top:r,"background-color":s}),/**
       * Append the ripple to the wrapper
       */
n.append(u),/**
       * Make sure the ripple has the styles applied (ugly hack but it works)
       */
function(){return e.getComputedStyle(u[0]).opacity}(),/**
       * Turn on the ripple animation
       */
a.rippleOn(o,u),/**
       * Call the rippleEnd function when the transition "on" ends
       */
setTimeout(function(){a.rippleEnd(u)},500),/**
       * Detect when the user leaves the element
       */
o.on("mouseup mouseleave touchend",function(){u.data("mousedown","off"),"off"===u.data("animating")&&a.rippleOut(u)})}}})},/**
   * Get the new size based on the element height/width and the ripple width
   */
n.prototype.getNewSize=function(t,e){return Math.max(t.outerWidth(),t.outerHeight())/e.outerWidth()*2.5},/**
   * Get the relX
   */
n.prototype.getRelX=function(t,e){var o=t.offset();/**
       * Make sure the user is using only one finger and then get the touch
       * position relative to the ripple wrapper
       */
return a.isTouch()?(e=e.originalEvent,1!==e.touches.length&&e.touches[0].pageX-o.left):e.pageX-o.left},/**
   * Get the relY
   */
n.prototype.getRelY=function(t,e){var o=t.offset();/**
       * Make sure the user is using only one finger and then get the touch
       * position relative to the ripple wrapper
       */
return a.isTouch()?(e=e.originalEvent,1!==e.touches.length&&e.touches[0].pageY-o.top):e.pageY-o.top},/**
   * Get the ripple color
   */
n.prototype.getRipplesColor=function(t){var o=t.data("ripple-color")?t.data("ripple-color"):e.getComputedStyle(t[0]).color;return o},/**
   * Verify if the client browser has transistion support
   */
n.prototype.hasTransitionSupport=function(){var t=o.body||o.documentElement,e=t.style,n=e.transition!==i||e.WebkitTransition!==i||e.MozTransition!==i||e.MsTransition!==i||e.OTransition!==i;return n},/**
   * Verify if the client is using a mobile device
   */
n.prototype.isTouch=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},/**
   * End the animation of the ripple
   */
n.prototype.rippleEnd=function(t){t.data("animating","off"),"off"===t.data("mousedown")&&a.rippleOut(t)},/**
   * Turn off the ripple effect
   */
n.prototype.rippleOut=function(t){t.off(),a.hasTransitionSupport()?t.addClass("ripple-out"):t.animate({opacity:0},100,function(){t.trigger("transitionend")}),t.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){t.remove()})},/**
   * Turn on the ripple effect
   */
n.prototype.rippleOn=function(t,e){var o=a.getNewSize(t,e);a.hasTransitionSupport()?e.css({"-ms-transform":"scale("+o+")","-moz-transform":"scale("+o+")","-webkit-transform":"scale("+o+")",transform:"scale("+o+")"}).addClass("ripple-on").data("animating","on").data("mousedown","on"):e.animate({width:2*Math.max(t.outerWidth(),t.outerHeight()),height:2*Math.max(t.outerWidth(),t.outerHeight()),"margin-left":Math.max(t.outerWidth(),t.outerHeight())*-1,"margin-top":Math.max(t.outerWidth(),t.outerHeight())*-1,opacity:.2},500,function(){e.trigger("transitionend")})},/**
   * Create the jquery plugin function
   */
t.fn.ripples=function(e){return this.each(function(){t.data(this,"plugin_"+r)||t.data(this,"plugin_"+r,new n(this,e))})}}(jQuery,window,document);